Модель БД  компании-перевозчика  для обработки и хранения транзакций при оплате транспортной картой.


Описание процесса:
Водитель перед выездом на линию получает документы на машину, а также некое устройство, способное читать транспортные карты.
Назовем его валидатор. Валидатор нужно подготовить к работе, считав им последовательно карту маршрута и карту кондуктора.
Карта маршрута формирует стоимость транзакции на устройстве. 
Карта кондуктора выдается водителю при приеме на работу и связывает конкретного водителя с транзакциями на валидаторе. 
Далее он может выезжать, и если пассажир поднесет транспортную карту к валидатору, создастся транзакция,
которая пока будет храниться на устройстве.
После работы водитель сдает валидатор, с которого при помощи софта тут же сливаются транзакции в текстовых файлах. 
Каждая строка представляет собой строчку в текстовом файле вида 
36126106114863876,252,0,7900,"11.03.2019 07:32:54",1,3,862,8,238,992705,2976,7777777777,72,55600,78B5EA29E0D4BDE7,m,805880000433188A,"","",3,8,0
Здесь есть номер транспортной карты пассажира, номер карты кондуктора, номер карты маршрута, сумма транзакции, дата транзакции,
уникальная цифровая подпись и еще некоторая не очень нужная информация.  
Затем, в определенное время запускается процесс сбора всех этих текстовых файлов,  построчно транзакции должны быть записаны в БД.
Перед записью нужно проверить, есть ли она уже в базе  по цифровой подписи.
 
Основная проблема:
Примем, что в сутки таких транзакций пишется  порядка 100000. 
Сложность, тут в том что основная табличка Transactions, должна быстро делать инсерты, так как время, 
за которое должна произойти запись, ограничена.
Но также она представляет интерес для аналитических отчетов, вариации которых практически неограничены. 

Описание сущностей:
1)Transactions  - транзакции
-TranID bigint    - айди
-TranDate smalldatetime   - дата транзакции
-TranAction datetime  -  дата и время транзакции
-RouteCode nvarchar (10)  - номер карты маршрута
-ConductorCode nvarchar (10) - номер карты кондутора
-Summ money  - сумма транзакции
-PassengerCardNumber nvarchar(50)  - номер транпортной карты пассажира
-Sign nvarchar(50)  - цифровая подпись

2)ConductorCards - карты кондуктора
-CondictorCardID int  -  айди
-ConductorCode nvarchar(10) -  номер карты
-EmpID int   - айди водителя 
-DateFrom smalldatetime -  дата начала периода
-DateTo smalldatetime -  дата конца периода
-Comments  nvarchar (500)  - комментарий

3)RouteCards  - карты, закрепленные за маршрутом
-RouteCardID int  -  айди
-RouteID int  - айди маршрута
-RouteCode nvarchar(50)  - номер карты 
-DateFrom smalldatetime   - дата начала периода
-DateTo smalldatetime  - дата конца периода

4)Routes   - маршруты
-RouteID int   - айди 
-RouteName nvarchar(10)  - название маршрута
-StatusID tinyint - из табл. Statuses

5)RouteStates  - состояние маршрутов (изменяющиеся данные)
-RouteStateID int - айди
-RouteID int  - айди маршрута
-RoutePrice money  - стоимость 
-RouteLength int  - протяженность , км
-RouteRunLength int  - суточный пробег на маршруте, км
-MainPoints  nvarchar(200)  -  описание маршрута
-DateFrom smalldatetime  - дата начала периода
-DateTo smalldatetime - дата конца периода

6)Employees - водители
-EmployeeID int  - айди
-FirstName nvarchar(50)  - имя
-LastName nvarchar(20)  - фамилия
-PnoneNumber nvarchar(50) - телефон
-BirthDate smalldatetime - дата рождения

7) EmployeeStates - состояния водителей 
-EmployeeStateID int - айди
-EmployeeID int    - айди водителя
-EmpInternalID int  - табельный
-CarID int - айди  машины
-ShiftID int  - номер смены (1 или 2)
-DateFrom smalldatetime  - дата начала периода
-DateTo smalldatetime - дата конца периода

8)Cars  - автобусы 
-CarID  int   - айди
-StateNumber nvarchar(50)  - гос.номер
-RegistrationDate  smalldatetime  - дата регистрации
-StatusID tinyint - из табл. Statuses
-ModelID int - айди модели

9) CarStates - состояния автобусов
-CarStateID int  - айди
-CarID   int  - айди автобуса
-CarInternalID int - гаражный номер
-RouteID  int - айди маршрута
-DateFrom smalldatetime  - дата начала периода
-DateTo smalldatetime - дата конца периода

10)Models  модели
-ModelID int  - айди
-ModelName nvarchar(50)  - название модели
-FuelRate int - расход на 100 км, литры.

11)EmployeeActions  - приказы по кадрам
-EmployeeActionID bigint - айди
-EmployeeID int - айди водителя
-ActionType nvarchar(50) - тип активности (принят, уволен, повторно принят)
-ActionDate datetime - дата активности
-Comments nvarchar(500) -комментарий

12) Statuses - справочник статусов
-StatusID tinyint  -айди
-StatusName nvarchar(20) -название статуса (активен/неактивен)
-Comments nvarchar(200)  


